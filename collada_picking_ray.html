<!doctype html>
<html lang="en">
<head>
    <title>Mouse-picking Collada models with three.js and ReusableRay</title>
    <meta charset="utf-8">
    <style>
        body {
            background-color: #f0f0f0;
            margin: 0px;
            overflow: hidden;
            font-family:Monospace;
            font-size:13px;
            text-align:center;
            font-weight: bold;
            text-align:center;
        }

        a {
            color:#0078ff;
        }

        #info {
            color:#fff;
            position: absolute;
            top: 0px; width: 100%;
            padding: 5px;
            z-index:100;
        }

        #stats {
            position: absolute;
            right: 10px;
            top: 5px;
            width: 200px;
            color:#fff;
            text-align: left;
        }

    </style>
</head>
<body>

<div id="info">
    - mouse-picking Collada models <a href="http://github.com/mrdoob/three.js" target="_blank">three.js</a> -<br>
</div>

<div id="stats">
</div>

<script src="three.js/build/Three.js"></script>
<script src="three.js/ColladaLoader.js"></script>

<script src="ReusableRay.js"></script>

<script src="three.js/js/Detector.js"></script>
<script src="three.js/js/Stats.js"></script>

<script>

if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

var container, stats;
var camera, controls, scene, renderer;

var clock = new THREE.Clock();

var SCREEN_HEIGHT = window.innerHeight;
var SCREEN_WIDTH  = window.innerWidth;

init();
animate();

function init() {

    container = document.createElement( 'div' );
    document.body.appendChild( container );

    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera( 25, SCREEN_WIDTH / SCREEN_HEIGHT, 50, 1e7 );
    camera.position.y = 100;
    //camera.position.z = 1000;
    //camera.lookAt(scene.position);
    scene.add( camera );

    controls = new THREE.FirstPersonControls( camera );
    controls.movementSpeed = 50;
    controls.lookSpeed = 0.02;

    renderer = new THREE.WebGLRenderer({ antialias: true, preserveDrawingBuffer : true } /* { clearAlpha: 1 } */);
    renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
    container.appendChild(renderer.domElement);

    stats = new Stats();
    stats.domElement.style.position = 'absolute';
    stats.domElement.style.top = '0px';
    container.appendChild( stats.domElement );

    lastTime = +new Date();

    var ambientLight = new THREE.AmbientLight( 0x606060 );
	scene.add( ambientLight );

    var light = new THREE.DirectionalLight( 0xffffff, 2 );
    light.position.set( 1, 1, 1 ).normalize();
    scene.add( light );

    var light = new THREE.DirectionalLight( 0xffffff );
    light.position.set( -1, -1, -1 ).normalize();
    scene.add( light );


    // grid

    plane = new THREE.Mesh( new THREE.PlaneGeometry( 1000, 1000, 20, 20 ), new THREE.MeshBasicMaterial( { color: 0x555555, wireframe: true } ) );
    scene.add( plane );

}

function createBoxes() {
    var boxCount = 20;
    var geometry = new THREE.CubeGeometry(20, 20, 20);

    for (var i = 0; i < boxCount; i++) {

        var object = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({ color:Math.random() * 0xffffff }));

        object.position.x = Math.random() * 800 - 400;
        object.position.y = Math.random() * 800 - 400;
        object.position.z = Math.random() * 800 - 800;

        object.rotation.x = ( Math.random() * 360 ) * Math.PI / 180;
        object.rotation.y = ( Math.random() * 360 ) * Math.PI / 180;
        object.rotation.z = ( Math.random() * 360 ) * Math.PI / 180;

        object.scale.x = Math.random() * 2 + 1;
        object.scale.y = Math.random() * 2 + 1;
        object.scale.z = Math.random() * 2 + 1;

        object.hitCounter = 0;
        object.isHit = false;

        scene.add(object);
    }
}

function animate() {

    var delta = clock.getDelta();

    requestAnimationFrame( animate );

    render(delta);
    stats.update();

}

function render(delta) {

    controls.update( delta );

    renderer.render( scene, camera );
}


</script>

<script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-10931011-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

</script>

</body>
</html>
